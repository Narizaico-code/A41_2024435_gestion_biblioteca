<!DOCTYPE html>
<h:html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Gestión de generos</title>
        <link rel="stylesheet" href="https://unpkg.com/primeflex@latest/primeflex.css"/>
        <link rel="stylesheet" href="https://unpkg.com/primeflex@latest/themes/primeone-dark.css"/>
    </h:head>
    <h:body>
        <div class="p-3">
            <h:form id="formulario-generos">
                <p:growl id="mensaje_emergente" showDetail="true" life="3000" />
                
                <div class="flex justify-content-between align-items-center mb-3">
                    <p:commandButton value="Volver al Menú Principal" action="index?faces-redirect=true" 
                                   icon="pi pi-arrow-left" styleClass="p-button-secondary"/>
                    
                    <p:commandButton value="Agregar Género" icon="pi pi-plus" 
                                   action="#{generosController.agregarGenero}" 
                                   oncomplete="PF('ventanaModalGenero').show()" update=":formulario-generos:genero-form"/>
                </div>
                
                <p:dataTable id="tabla-generos" value="#{generosController.generos}" var="genero"
                           class="p-datatable-gridlines">
                    <p:column headerText="Código" >
                        <h:outputText value="#{genero.codigoGenero}"/>
                    </p:column>

                    <p:column headerText="Tipo" sortBy="#{genero.tipo}" filterBy="#{genero.tipo}">
                        <h:outputText value="#{genero.tipo}"/>
                    </p:column>
                    
                    <p:column headerText="Descripción" >
                        <h:outputText value="#{genero.descripcion}"/>
                    </p:column>
                    
                    <p:column headerText="Acciones" >
                        <div class="flex gap-2">
                            <p:commandButton icon="pi pi-pencil" title="Editar"
                                           action="#{generosController.editarGenero(genero)}"
                                           oncomplete="PF('ventanaModalGenero').show()"
                                             process="@this"
                                           update=":formulario-generos:genero-form"/>
                            
                            <p:commandButton icon="pi pi-trash" title="Eliminar" 
                                           action="#{generosController.eliminarGenero}"
                                           update=":formulario-generos:mensaje_emergente, :formulario-generos:tabla-generos"/>
                        </div>
                    </p:column>
                </p:dataTable>
                
                <p:dialog header="Datos del Género" widgetVar="ventanaModalGenero" modal="true" 
                        class="w-6">
                    <h:panelGrid id="genero-form" class="w-full">
                        <p:outputLabel for="tipo" value="Tipo:" />
                        <p:inputText id="tipo" value="#{generosController.generoSeleccionado.tipo}" 
                                   required="true" class="w-full"/>
                        
                        <p:outputLabel for="descripcion" value="Descripción:" />
                        <p:inputText id="descripcion" value="#{generosController.generoSeleccionado.descripcion}" 
                                   class="w-full"/>
                    </h:panelGrid>
                    
                    <f:facet name="footer">
                        <div class="flex justify-content-end gap-2">
                            <p:commandButton value="Cancelar" onclick="PF('ventanaModalGenero').hide()" 
                                           class="p-button-secondary"/>
                            <p:commandButton value="Guardar" action="#{generosController.guardarGenero}" 
                                           update=":formulario-generos:mensaje_emergente, :formulario-generos:tabla-generos"/>
                        </div>
                    </f:facet>
                </p:dialog>
            </h:form>
        </div>
    </h:body>
</h:html>